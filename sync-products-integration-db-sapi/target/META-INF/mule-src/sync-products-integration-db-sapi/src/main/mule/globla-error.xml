<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<error-handler name="globla-errorError_Handler" doc:id="0e604f12-07b3-4515-8ca8-bf2b5d93d59b" >
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate3" doc:id="996ea399-3af0-41e1-a172-ff720f00f5f5" type="APIKIT:NOT_ACCEPTABLE,APIKIT:BAD_REQUEST,APIKIT:NOT_FOUND,APIKIT:METHOD_NOT_ALLOWED,APIKIT:UNSUPPORTED_MEDIA_TYPE,APIKIT:NOT_IMPLEMENTED" >
			<flow-ref doc:name="Flow Reference" doc:id="b5409c0b-5110-477c-818b-16506ef94816" name="globla-errorSub_Flow"/>
		</on-error-propagate>
	</error-handler>
	<error-handler name="globla-errorError_Handler1" doc:id="62264d86-5952-4df5-b4bb-713aa3e4cbd5" >
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="f3202fa9-981b-4ffb-9395-f0fe554195da" type="DB:BAD_SQL_SYNTAX,DB:CONNECTIVITY,DB:QUERY_EXECUTION">
			<flow-ref doc:name="Flow Reference" doc:id="91702b45-00c2-4097-bc86-27cf8f106cc6" name="globla-errorSub_Flow"/>
		</on-error-propagate>
	</error-handler>
	<sub-flow name="globla-errorSub_Flow" doc:id="9178d43c-5215-4d42-ac4f-6c3eab5e439a" >
		<ee:transform doc:name="errorResponseOfApi" doc:id="ed7b87f7-3cb1-4087-8747-4c37e4cde5d1">
				<ee:message>
					<ee:set-payload><![CDATA[%dw 2.0
output application/json
---
{
	
	"applicationName": app.name,
	"correlationId": vars.correlationID default correlationId,
	"code": (error.errorType.namespace as String ++ ":" ++ error.errorType.identifier as String),
	"description": error.description,
	"status" : "failure",
	"code" : 0
}]]></ee:set-payload>
				</ee:message>
			</ee:transform>
	</sub-flow>
</mule>
